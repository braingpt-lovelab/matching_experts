Loading 994516 samples for training
Loading 994516 samples for training
Loading 994516 samples for training
Loading 994516 samples for training
Start training
Start training
Start training
Start training
Epoch 0 | Batch 999/31079 | Training PPL: 6927.749756411053 | time 580.0324699878693
Epoch 0 | Batch 1999/31079 | Training PPL: 2540.6752354340697 | time 1157.7770586013794
Epoch 0 | Batch 2999/31079 | Training PPL: 1031.494105982446 | time 1735.552613735199
Epoch 0 | Batch 3999/31079 | Training PPL: 719.77246867093 | time 2313.4393577575684
Epoch 0 | Batch 4999/31079 | Training PPL: 370.72377691596313 | time 2891.390457868576
Epoch 0 | Batch 5999/31079 | Training PPL: 428.09219002470104 | time 3469.2148995399475
Epoch 0 | Batch 6999/31079 | Training PPL: 286.5105622791391 | time 4047.14200425148
Epoch 0 | Batch 7999/31079 | Training PPL: 230.68912697260012 | time 4625.036548137665
Epoch 0 | Batch 8999/31079 | Training PPL: 187.13166820067286 | time 5202.9777138233185
Epoch 0 | Batch 9999/31079 | Training PPL: 180.23886673581217 | time 5780.903275251389
Epoch 0 | Validation PPL: 169.27983484970864 | Learning rate: 1.993817937228149e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.0_10000
Epoch 0 | Batch 10999/31079 | Training PPL: 125.95481038517038 | time 6420.91814160347
Epoch 0 | Batch 11999/31079 | Training PPL: 157.7314672036796 | time 6999.066144943237
Epoch 0 | Batch 12999/31079 | Training PPL: 159.52129274131295 | time 7576.5225150585175
Epoch 0 | Batch 13999/31079 | Training PPL: 166.98121116031476 | time 8154.736144781113
Epoch 0 | Batch 14999/31079 | Training PPL: 109.97882188174604 | time 8732.386036396027
Epoch 0 | Batch 15999/31079 | Training PPL: 93.63715692706364 | time 9309.877795219421
Epoch 0 | Batch 16999/31079 | Training PPL: 106.77882914395678 | time 9888.164382219315
Epoch 0 | Batch 17999/31079 | Training PPL: 74.86262405086549 | time 10465.74180984497
Epoch 0 | Batch 18999/31079 | Training PPL: 68.11540010602391 | time 11043.741228103638
Epoch 0 | Batch 19999/31079 | Training PPL: 46.14043110789912 | time 11620.96593117714
Epoch 0 | Validation PPL: 62.31918865586153 | Learning rate: 1.9493405666805684e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.0_20000
Epoch 0 | Batch 20999/31079 | Training PPL: 80.48931687112815 | time 12261.988358259201
Epoch 0 | Batch 21999/31079 | Training PPL: 46.303032805746454 | time 12839.971544742584
Epoch 0 | Batch 22999/31079 | Training PPL: 55.3134306020418 | time 13417.941473007202
Epoch 0 | Batch 23999/31079 | Training PPL: 36.96216243499909 | time 13995.995333194733
Epoch 0 | Batch 24999/31079 | Training PPL: 55.17052843197484 | time 14573.996386528015
Epoch 0 | Batch 25999/31079 | Training PPL: 46.34014039800942 | time 15151.998721599579
Epoch 0 | Batch 26999/31079 | Training PPL: 58.15100243081814 | time 15729.975516557693
Epoch 0 | Batch 27999/31079 | Training PPL: 49.909985844128414 | time 16307.959422826767
Epoch 0 | Batch 28999/31079 | Training PPL: 36.790463812779095 | time 16885.979452371597
Epoch 0 | Batch 29999/31079 | Training PPL: 36.1452532639786 | time 17463.989186525345
Epoch 0 | Validation PPL: 37.72857722155749 | Learning rate: 1.863776265340226e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.0_30000
Epoch 0 | Batch 30999/31079 | Training PPL: 38.340482009360684 | time 18106.185139894485
End of epoch 0 | Validation PPL: 36.48373729236205 | Learning rate: 1.852304043748133e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.0
Epoch 1 | Batch 999/31079 | Training PPL: 41.519448532094174 | time 579.9141712188721
Epoch 1 | Batch 1999/31079 | Training PPL: 39.447187777833534 | time 1158.5236127376556
Epoch 1 | Batch 2999/31079 | Training PPL: 35.90453015876365 | time 1737.020274400711
Epoch 1 | Batch 3999/31079 | Training PPL: 41.70297470375372 | time 2315.552393436432
Epoch 1 | Batch 4999/31079 | Training PPL: 27.722382356128296 | time 2894.106337070465
Epoch 1 | Batch 5999/31079 | Training PPL: 46.17373134596829 | time 3472.6697442531586
Epoch 1 | Batch 6999/31079 | Training PPL: 29.863548764592583 | time 4051.1848306655884
Epoch 1 | Batch 7999/31079 | Training PPL: 34.021439196709316 | time 4629.683513402939
Epoch 1 | Batch 8999/31079 | Training PPL: 24.16262607094163 | time 5208.222995996475
Epoch 1 | Batch 9999/31079 | Training PPL: 26.525263793685312 | time 5786.725812911987
Epoch 1 | Validation PPL: 29.12079634484341 | Learning rate: 1.7256375722121688e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.1_10000
Epoch 1 | Batch 10999/31079 | Training PPL: 24.234056144610413 | time 6428.816144227982
Epoch 1 | Batch 11999/31079 | Training PPL: 31.754767134331736 | time 7007.466432094574
Epoch 1 | Batch 12999/31079 | Training PPL: 37.66859103615231 | time 7586.042540311813
Epoch 1 | Batch 13999/31079 | Training PPL: 44.98792408944679 | time 8164.616388320923
Epoch 1 | Batch 14999/31079 | Training PPL: 33.69365117784221 | time 8743.09200000763
Epoch 1 | Batch 15999/31079 | Training PPL: 27.87289190359109 | time 9321.596710920334
Epoch 1 | Batch 16999/31079 | Training PPL: 38.28354795178466 | time 9900.115282297134
Epoch 1 | Batch 17999/31079 | Training PPL: 28.958804641267655 | time 10478.726082086563
Epoch 1 | Batch 18999/31079 | Training PPL: 27.09062318878635 | time 11057.29505109787
Epoch 1 | Batch 19999/31079 | Training PPL: 18.057952306486047 | time 11635.838819742203
Epoch 1 | Validation PPL: 25.207741644956148 | Learning rate: 1.5675659108460086e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.1_20000
Epoch 1 | Batch 20999/31079 | Training PPL: 34.22306584222558 | time 12278.030161619186
Epoch 1 | Batch 21999/31079 | Training PPL: 21.32954930995172 | time 12856.684540748596
Epoch 1 | Batch 22999/31079 | Training PPL: 25.94580182454961 | time 13435.270288228989
Epoch 1 | Batch 23999/31079 | Training PPL: 18.93183719725286 | time 14013.810693025589
Epoch 1 | Batch 24999/31079 | Training PPL: 28.236608947095533 | time 14592.388776302338
Epoch 1 | Batch 25999/31079 | Training PPL: 24.576707733037086 | time 15170.987844467163
Epoch 1 | Batch 26999/31079 | Training PPL: 32.75406325746018 | time 15749.556494951248
Epoch 1 | Batch 27999/31079 | Training PPL: 27.946713727645502 | time 16328.087905883789
Epoch 1 | Batch 28999/31079 | Training PPL: 21.431034426814836 | time 16906.58400297165
Epoch 1 | Batch 29999/31079 | Training PPL: 20.59369734790657 | time 17485.132827043533
Epoch 1 | Validation PPL: 22.810829758525692 | Learning rate: 1.384930313082609e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.1_30000
Epoch 1 | Batch 30999/31079 | Training PPL: 23.333846975026187 | time 18126.768854618073
End of epoch 1 | Validation PPL: 22.584456103063413 | Learning rate: 1.3642155158085106e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.1
Epoch 2 | Batch 999/31079 | Training PPL: 26.202231620935986 | time 579.4800379276276
Epoch 2 | Batch 1999/31079 | Training PPL: 23.306503080152176 | time 1158.0223381519318
Epoch 2 | Batch 2999/31079 | Training PPL: 22.29701578998768 | time 1736.5465054512024
Epoch 2 | Batch 3999/31079 | Training PPL: 26.37514462705957 | time 2315.0818209648132
Epoch 2 | Batch 4999/31079 | Training PPL: 18.04225751458226 | time 2893.610502719879
Epoch 2 | Batch 5999/31079 | Training PPL: 30.40511536164941 | time 3472.12069106102
Epoch 2 | Batch 6999/31079 | Training PPL: 19.571942067878453 | time 4050.6590926647186
Epoch 2 | Batch 7999/31079 | Training PPL: 23.561821664284242 | time 4629.203842639923
Epoch 2 | Batch 8999/31079 | Training PPL: 17.024270903931853 | time 5207.750907659531
Epoch 2 | Batch 9999/31079 | Training PPL: 18.685275467026244 | time 5786.310475826263
Epoch 2 | Validation PPL: 21.047745680824708 | Learning rate: 1.1636369819264742e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.2_10000
Epoch 2 | Batch 10999/31079 | Training PPL: 17.889764011690406 | time 6428.307932853699
Epoch 2 | Batch 11999/31079 | Training PPL: 22.458465669353334 | time 7007.283414840698
Epoch 2 | Batch 12999/31079 | Training PPL: 26.018905145435614 | time 7586.303656578064
Epoch 2 | Batch 13999/31079 | Training PPL: 32.00524212811432 | time 8165.332770824432
Epoch 2 | Batch 14999/31079 | Training PPL: 25.544864937651283 | time 8744.3910882473
Epoch 2 | Batch 15999/31079 | Training PPL: 21.377782472029818 | time 9323.430859804153
Epoch 2 | Batch 16999/31079 | Training PPL: 29.344701598769824 | time 9902.443391084671
Epoch 2 | Batch 17999/31079 | Training PPL: 22.437833495207684 | time 10481.470666646957
Epoch 2 | Batch 18999/31079 | Training PPL: 21.000217102387367 | time 11060.488282680511
Epoch 2 | Batch 19999/31079 | Training PPL: 14.123256798247128 | time 11639.478189229965
Epoch 2 | Validation PPL: 19.96346068631323 | Learning rate: 9.559763306383965e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.2_20000
Epoch 2 | Batch 20999/31079 | Training PPL: 26.91909032547862 | time 12280.7399559021
Epoch 2 | Batch 21999/31079 | Training PPL: 16.958372608397788 | time 12859.69123506546
Epoch 2 | Batch 22999/31079 | Training PPL: 20.73611862463294 | time 13438.641655921936
Epoch 2 | Batch 23999/31079 | Training PPL: 15.552930935362628 | time 14017.70732498169
Epoch 2 | Batch 24999/31079 | Training PPL: 22.7929114193701 | time 14596.703045368195
Epoch 2 | Batch 25999/31079 | Training PPL: 20.036660097790843 | time 15175.748728752136
Epoch 2 | Batch 26999/31079 | Training PPL: 26.93584654781057 | time 15754.761996030807
Epoch 2 | Batch 27999/31079 | Training PPL: 22.794253719521215 | time 16333.709806203842
Epoch 2 | Batch 28999/31079 | Training PPL: 18.047747203177163 | time 16912.648290634155
Epoch 2 | Batch 29999/31079 | Training PPL: 17.04496764149189 | time 17491.625180006027
Epoch 2 | Validation PPL: 19.187580298881084 | Learning rate: 7.502209992321274e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.2_30000
Epoch 2 | Batch 30999/31079 | Training PPL: 19.46270166661208 | time 18134.029831647873
End of epoch 2 | Validation PPL: 19.123819427262305 | Learning rate: 7.2865132095249525e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.2
Epoch 3 | Batch 999/31079 | Training PPL: 22.268147226578943 | time 579.9751358032227
Epoch 3 | Batch 1999/31079 | Training PPL: 19.298704063762084 | time 1158.6765887737274
Epoch 3 | Batch 2999/31079 | Training PPL: 19.10129522302629 | time 1737.2439458370209
Epoch 3 | Batch 3999/31079 | Training PPL: 22.489194819260092 | time 2315.7915694713593
Epoch 3 | Batch 4999/31079 | Training PPL: 15.572867364791268 | time 2894.347227334976
Epoch 3 | Batch 5999/31079 | Training PPL: 25.766996979705166 | time 3472.9243063926697
Epoch 3 | Batch 6999/31079 | Training PPL: 16.553814269471044 | time 4051.6346340179443
Epoch 3 | Batch 7999/31079 | Training PPL: 20.388913218115164 | time 4630.145437240601
Epoch 3 | Batch 8999/31079 | Training PPL: 14.921258222024676 | time 5208.702353954315
Epoch 3 | Batch 9999/31079 | Training PPL: 16.289549503955683 | time 5787.276227235794
Epoch 3 | Validation PPL: 18.60515232428259 | Learning rate: 5.353776190340671e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.3_10000
Epoch 3 | Batch 10999/31079 | Training PPL: 16.031857815409886 | time 6429.334244966507
Epoch 3 | Batch 11999/31079 | Training PPL: 19.577332403405943 | time 7008.413507699966
Epoch 3 | Batch 12999/31079 | Training PPL: 22.725398621271534 | time 7587.470855474472
Epoch 3 | Batch 13999/31079 | Training PPL: 27.809639619700565 | time 8166.488739013672
Epoch 3 | Batch 14999/31079 | Training PPL: 22.72396827277318 | time 8745.516762256622
Epoch 3 | Batch 15999/31079 | Training PPL: 19.133351102213876 | time 9324.581817150116
Epoch 3 | Batch 16999/31079 | Training PPL: 26.156542737747497 | time 9903.549827337265
Epoch 3 | Batch 17999/31079 | Training PPL: 20.087270530991177 | time 10482.571989774704
Epoch 3 | Batch 18999/31079 | Training PPL: 19.034939051212845 | time 11061.544957399368
Epoch 3 | Batch 19999/31079 | Training PPL: 12.933244659127304 | time 11640.534233808517
Epoch 3 | Validation PPL: 18.227926056747783 | Learning rate: 3.6221251489553254e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.3_20000
Epoch 3 | Batch 20999/31079 | Training PPL: 24.41293664258597 | time 12282.829767465591
Epoch 3 | Batch 21999/31079 | Training PPL: 15.43647105327381 | time 12862.732038736343
Epoch 3 | Batch 22999/31079 | Training PPL: 19.09810761646206 | time 13442.0072619915
Epoch 3 | Batch 23999/31079 | Training PPL: 14.310742854250723 | time 14022.087233543396
Epoch 3 | Batch 24999/31079 | Training PPL: 20.995411084168 | time 14601.457606554031
Epoch 3 | Batch 25999/31079 | Training PPL: 18.488485136636765 | time 15181.181473016739
Epoch 3 | Batch 26999/31079 | Training PPL: 24.773634875215397 | time 15760.24055814743
Epoch 3 | Batch 27999/31079 | Training PPL: 21.35155992985474 | time 16339.263868808746
Epoch 3 | Batch 28999/31079 | Training PPL: 16.81979949906256 | time 16918.26459789276
Epoch 3 | Batch 29999/31079 | Training PPL: 15.842176181991242 | time 17497.29862689972
Epoch 3 | Validation PPL: 17.96939810986251 | Learning rate: 2.166504977635959e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.3_30000
Epoch 3 | Batch 30999/31079 | Training PPL: 18.285360188208948 | time 18139.53454899788
End of epoch 3 | Validation PPL: 17.96609954910968 | Learning rate: 2.0295978575124462e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.3
Epoch 4 | Batch 999/31079 | Training PPL: 20.893946313330616 | time 579.8143546581268
Epoch 4 | Batch 1999/31079 | Training PPL: 18.035918056325993 | time 1158.3883533477783
Epoch 4 | Batch 2999/31079 | Training PPL: 17.820625995055853 | time 1736.9206357002258
Epoch 4 | Batch 3999/31079 | Training PPL: 21.30621519119428 | time 2315.4718430042267
Epoch 4 | Batch 4999/31079 | Training PPL: 14.612486763660753 | time 2893.9859206676483
Epoch 4 | Batch 5999/31079 | Training PPL: 24.06950949367292 | time 3472.581928730011
Epoch 4 | Batch 6999/31079 | Training PPL: 15.640763519248662 | time 4051.113564968109
Epoch 4 | Batch 7999/31079 | Training PPL: 19.480612062922834 | time 4629.643902540207
Epoch 4 | Batch 8999/31079 | Training PPL: 14.327382349926038 | time 5208.187077999115
Epoch 4 | Batch 9999/31079 | Training PPL: 15.474698171057554 | time 5786.8183517456055
Epoch 4 | Validation PPL: 17.822610280329812 | Learning rate: 9.524998728201785e-07
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.4_10000
Epoch 4 | Batch 10999/31079 | Training PPL: 15.351428979862392 | time 6428.5914940834045
Epoch 4 | Batch 11999/31079 | Training PPL: 18.688260499709195 | time 7007.24440908432
Epoch 4 | Batch 12999/31079 | Training PPL: 21.65735842547396 | time 7585.863525152206
Epoch 4 | Batch 13999/31079 | Training PPL: 26.993429921089902 | time 8164.50423002243
Epoch 4 | Batch 14999/31079 | Training PPL: 21.97888911540146 | time 8743.185715913773
Epoch 4 | Batch 15999/31079 | Training PPL: 18.411185427046142 | time 9321.93677520752
Epoch 4 | Batch 16999/31079 | Training PPL: 25.528560131455958 | time 9900.544895887375
Epoch 4 | Batch 17999/31079 | Training PPL: 19.435820603901018 | time 10479.122846603394
Epoch 4 | Batch 18999/31079 | Training PPL: 18.453479139677672 | time 11057.757964849472
Epoch 4 | Batch 19999/31079 | Training PPL: 12.54531065672546 | time 11636.373276948929
Epoch 4 | Validation PPL: 17.767980943412265 | Learning rate: 2.669726527405869e-07
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.4_20000
Epoch 4 | Batch 20999/31079 | Training PPL: 23.612011911080426 | time 12278.546838760376
Epoch 4 | Batch 21999/31079 | Training PPL: 15.112573170471059 | time 12857.635679244995
Epoch 4 | Batch 22999/31079 | Training PPL: 18.630653536310167 | time 13436.688825845718
Epoch 4 | Batch 23999/31079 | Training PPL: 14.081873472876799 | time 14015.7422041893
Epoch 4 | Batch 24999/31079 | Training PPL: 20.59703636420855 | time 14594.843554258347
Epoch 4 | Batch 25999/31079 | Training PPL: 18.03551385164755 | time 15173.900228738785
Epoch 4 | Batch 26999/31079 | Training PPL: 24.233957921372525 | time 15752.925349473953
Epoch 4 | Batch 27999/31079 | Training PPL: 20.75949655057366 | time 16331.976268053055
Epoch 4 | Batch 28999/31079 | Training PPL: 16.70121421611876 | time 16911.029785871506
Epoch 4 | Batch 29999/31079 | Training PPL: 15.399968489125927 | time 17490.136496782303
Epoch 4 | Validation PPL: 17.755971093370636 | Learning rate: 2.6854334113923795e-09
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.4_30000
Epoch 4 | Batch 30999/31079 | Training PPL: 18.034116405274133 | time 18132.403980731964
End of epoch 4 | Validation PPL: 17.756085394280294 | Learning rate: 3.474915192258621e-12
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer/checkpoint.4
