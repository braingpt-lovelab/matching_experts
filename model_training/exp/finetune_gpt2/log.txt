Loading 1131533 samples for training
Loading 1131533 samples for training
Loading 1131533 samples for training
Loading 1131533 samples for training
Start training
Start training
Start training
Start training
Epoch 0 | Batch 999/17681 | Training PPL: 20.57459189697543 | time 438.5453863143921
Epoch 0 | Batch 1999/17681 | Training PPL: 15.095630004092046 | time 874.9127974510193
Epoch 0 | Batch 2999/17681 | Training PPL: 16.245885083984685 | time 1311.2052483558655
Epoch 0 | Batch 3999/17681 | Training PPL: 14.606436502522316 | time 1747.4050569534302
Epoch 0 | Batch 4999/17681 | Training PPL: 14.5697116030939 | time 2183.6737112998962
Epoch 0 | Batch 5999/17681 | Training PPL: 15.726354782533319 | time 2619.925053834915
Epoch 0 | Batch 6999/17681 | Training PPL: 15.68976149633665 | time 3056.163722753525
Epoch 0 | Batch 7999/17681 | Training PPL: 12.445403244610446 | time 3492.3861055374146
Epoch 0 | Batch 8999/17681 | Training PPL: 12.561984784583142 | time 3928.6371653079987
Epoch 0 | Batch 9999/17681 | Training PPL: 14.32065116484521 | time 4364.819185018539
Epoch 0 | Validation PPL: 13.543567775723313 | Learning rate: 1.963991702665886e-05
Save checkpoint to exp/finetune_gpt2/checkpoint.0_10000
Epoch 0 | Batch 10999/17681 | Training PPL: 15.745327212353446 | time 4847.448190689087
Epoch 0 | Batch 11999/17681 | Training PPL: 15.616394545001336 | time 5301.1721732616425
Epoch 0 | Batch 12999/17681 | Training PPL: 16.395155004680817 | time 5754.90346288681
Epoch 0 | Batch 13999/17681 | Training PPL: 13.33292347235232 | time 6208.696657896042
Epoch 0 | Batch 14999/17681 | Training PPL: 16.445053745760006 | time 6662.412456274033
Epoch 0 | Batch 15999/17681 | Training PPL: 18.223385181784117 | time 7116.119753599167
Epoch 0 | Batch 16999/17681 | Training PPL: 16.282556405477184 | time 7569.827634096146
End of epoch 0 | Validation PPL: 13.116736590619922 | Learning rate: 1.8522551536929202e-05
Save checkpoint to exp/finetune_gpt2/checkpoint.0
Epoch 1 | Batch 999/17681 | Training PPL: 16.96542135498688 | time 454.8382134437561
Epoch 1 | Batch 1999/17681 | Training PPL: 13.258736788398378 | time 909.126097202301
Epoch 1 | Batch 2999/17681 | Training PPL: 15.294350486658077 | time 1363.2969584465027
Epoch 1 | Batch 3999/17681 | Training PPL: 13.674181736170349 | time 1817.3319466114044
Epoch 1 | Batch 4999/17681 | Training PPL: 13.960626285240274 | time 2271.290359735489
Epoch 1 | Batch 5999/17681 | Training PPL: 15.602844115558812 | time 2725.237161874771
Epoch 1 | Batch 6999/17681 | Training PPL: 15.47116038764599 | time 3179.1081142425537
Epoch 1 | Batch 7999/17681 | Training PPL: 12.556139884157657 | time 3633.0407090187073
Epoch 1 | Batch 8999/17681 | Training PPL: 12.641841927564588 | time 4087.0332248210907
Epoch 1 | Batch 9999/17681 | Training PPL: 14.395626952745104 | time 4541.030257940292
Epoch 1 | Validation PPL: 12.559696804899112 | Learning rate: 1.6083242988209938e-05
Save checkpoint to exp/finetune_gpt2/checkpoint.1_10000
Epoch 1 | Batch 10999/17681 | Training PPL: 13.938718842600647 | time 5023.849299430847
Epoch 1 | Batch 11999/17681 | Training PPL: 13.497731819304818 | time 5476.841220855713
Epoch 1 | Batch 12999/17681 | Training PPL: 14.849010009826532 | time 5931.0850694179535
Epoch 1 | Batch 13999/17681 | Training PPL: 11.959864458511138 | time 6385.308391332626
Epoch 1 | Batch 14999/17681 | Training PPL: 14.81346925783897 | time 6839.284300088882
Epoch 1 | Batch 15999/17681 | Training PPL: 16.759962425978053 | time 7293.084634542465
Epoch 1 | Batch 16999/17681 | Training PPL: 15.163205946403611 | time 7746.8920295238495
End of epoch 1 | Validation PPL: 12.298034690893111 | Learning rate: 1.364041419589193e-05
Save checkpoint to exp/finetune_gpt2/checkpoint.1
Epoch 2 | Batch 999/17681 | Training PPL: 15.849324008823094 | time 453.82846665382385
Epoch 2 | Batch 1999/17681 | Training PPL: 12.325635966124345 | time 907.7609372138977
Epoch 2 | Batch 2999/17681 | Training PPL: 14.352442892213956 | time 1361.735725402832
Epoch 2 | Batch 3999/17681 | Training PPL: 12.734995098230428 | time 1815.6401364803314
Epoch 2 | Batch 4999/17681 | Training PPL: 13.1878992853397 | time 2269.5904371738434
Epoch 2 | Batch 5999/17681 | Training PPL: 14.89738158352076 | time 2723.5206441879272
Epoch 2 | Batch 6999/17681 | Training PPL: 14.65926649041022 | time 3177.353968858719
Epoch 2 | Batch 7999/17681 | Training PPL: 11.871147090670014 | time 3631.1101126670837
Epoch 2 | Batch 8999/17681 | Training PPL: 12.171171547182947 | time 4084.874736070633
Epoch 2 | Batch 9999/17681 | Training PPL: 13.695709325012473 | time 4538.642914772034
Epoch 2 | Validation PPL: 12.06513595151333 | Learning rate: 1.0062697583996616e-05
Save checkpoint to exp/finetune_gpt2/checkpoint.2_10000
Epoch 2 | Batch 10999/17681 | Training PPL: 13.402807897348861 | time 5021.451746463776
Epoch 2 | Batch 11999/17681 | Training PPL: 12.829177252409353 | time 5475.142578840256
Epoch 2 | Batch 12999/17681 | Training PPL: 14.365229340060798 | time 5928.821632146835
Epoch 2 | Batch 13999/17681 | Training PPL: 11.492396888332795 | time 6382.513272762299
Epoch 2 | Batch 14999/17681 | Training PPL: 14.157647887506828 | time 6836.276387929916
Epoch 2 | Batch 15999/17681 | Training PPL: 16.18081227445895 | time 7290.049480676651
Epoch 2 | Batch 16999/17681 | Training PPL: 14.663052109057173 | time 7743.737737417221
End of epoch 2 | Validation PPL: 11.95271799959475 | Learning rate: 7.283814579689194e-06
Save checkpoint to exp/finetune_gpt2/checkpoint.2
Epoch 3 | Batch 999/17681 | Training PPL: 15.321606487448612 | time 453.8779785633087
Epoch 3 | Batch 1999/17681 | Training PPL: 11.994228127958953 | time 907.8831934928894
Epoch 3 | Batch 2999/17681 | Training PPL: 14.046551203700018 | time 1361.865355014801
Epoch 3 | Batch 3999/17681 | Training PPL: 12.454590165266017 | time 1815.8386979103088
Epoch 3 | Batch 4999/17681 | Training PPL: 12.967177043577582 | time 2269.8354547023773
Epoch 3 | Batch 5999/17681 | Training PPL: 14.703577054722942 | time 2723.8847970962524
Epoch 3 | Batch 6999/17681 | Training PPL: 14.309569192620735 | time 3177.920706987381
Epoch 3 | Batch 7999/17681 | Training PPL: 11.59782781685732 | time 3631.9179887771606
Epoch 3 | Batch 8999/17681 | Training PPL: 11.748642784441678 | time 4085.9078035354614
Epoch 3 | Batch 9999/17681 | Training PPL: 13.531293309011897 | time 4539.949579715729
Epoch 3 | Validation PPL: 11.86335216890121 | Learning rate: 4.016758030279277e-06
Save checkpoint to exp/finetune_gpt2/checkpoint.3_10000
Epoch 3 | Batch 10999/17681 | Training PPL: 13.139140727781998 | time 5022.889365911484
Epoch 3 | Batch 11999/17681 | Training PPL: 12.655575365464518 | time 5476.8115565776825
Epoch 3 | Batch 12999/17681 | Training PPL: 14.177742664868802 | time 5930.704536437988
Epoch 3 | Batch 13999/17681 | Training PPL: 11.323844540207467 | time 6384.597746372223
Epoch 3 | Batch 14999/17681 | Training PPL: 13.983654989492639 | time 6838.519024372101
Epoch 3 | Batch 15999/17681 | Training PPL: 16.080984414584822 | time 7292.422028541565
Epoch 3 | Batch 16999/17681 | Training PPL: 14.464738050080667 | time 7746.21076798439
End of epoch 3 | Validation PPL: 11.829552425613509 | Learning rate: 2.0273405863131478e-06
Save checkpoint to exp/finetune_gpt2/checkpoint.3
Epoch 4 | Batch 999/17681 | Training PPL: 15.185223963221606 | time 453.74949073791504
Epoch 4 | Batch 1999/17681 | Training PPL: 11.859664451770527 | time 907.4971766471863
Epoch 4 | Batch 2999/17681 | Training PPL: 13.878863074076259 | time 1361.2261385917664
Epoch 4 | Batch 3999/17681 | Training PPL: 12.323946352089362 | time 1814.9124705791473
Epoch 4 | Batch 4999/17681 | Training PPL: 12.847778530833386 | time 2268.5884754657745
Epoch 4 | Batch 5999/17681 | Training PPL: 14.566978065574686 | time 2722.279228448868
Epoch 4 | Batch 6999/17681 | Training PPL: 14.301963196998354 | time 3175.9766685962677
Epoch 4 | Batch 7999/17681 | Training PPL: 11.543603428249087 | time 3629.65606880188
Epoch 4 | Batch 8999/17681 | Training PPL: 11.68590112764106 | time 4083.267836332321
Epoch 4 | Batch 9999/17681 | Training PPL: 13.3541557828106 | time 4536.948011636734
Epoch 4 | Validation PPL: 11.81358572919787 | Learning rate: 3.9418683324378594e-07
Save checkpoint to exp/finetune_gpt2/checkpoint.4_10000
Epoch 4 | Batch 10999/17681 | Training PPL: 13.169596798203607 | time 5019.686399459839
Epoch 4 | Batch 11999/17681 | Training PPL: 12.581824409765128 | time 5473.577010154724
Epoch 4 | Batch 12999/17681 | Training PPL: 14.036939632978868 | time 5927.490766763687
Epoch 4 | Batch 13999/17681 | Training PPL: 11.262920309537156 | time 6381.412517309189
Epoch 4 | Batch 14999/17681 | Training PPL: 13.889121388678072 | time 6835.360283374786
Epoch 4 | Batch 15999/17681 | Training PPL: 15.920482644319225 | time 7289.288020849228
Epoch 4 | Batch 16999/17681 | Training PPL: 14.483355554136443 | time 7743.216572761536
End of epoch 4 | Validation PPL: 11.8111074002692 | Learning rate: 6.710015065802822e-13
Save checkpoint to exp/finetune_gpt2/checkpoint.4
