Loading 995782 samples for training
Loading 995782 samples for training
Loading 995782 samples for training
Loading 995782 samples for training
Start training
Start training
Start training
Start training
Epoch 0 | Batch 999/31119 | Training PPL: 7109.358743063695 | time 581.930924654007
Epoch 0 | Batch 1999/31119 | Training PPL: 2238.10780691216 | time 1164.326485157013
Epoch 0 | Batch 2999/31119 | Training PPL: 965.2327745472275 | time 1746.770382642746
Epoch 0 | Batch 3999/31119 | Training PPL: 564.923288315555 | time 2329.2344369888306
Epoch 0 | Batch 4999/31119 | Training PPL: 469.40430857823054 | time 2911.9530494213104
Epoch 0 | Batch 5999/31119 | Training PPL: 373.91603154784053 | time 3494.68559217453
Epoch 0 | Batch 6999/31119 | Training PPL: 349.5658085299827 | time 4077.2407443523407
Epoch 0 | Batch 7999/31119 | Training PPL: 225.66684024362172 | time 4660.04364323616
Epoch 0 | Batch 8999/31119 | Training PPL: 229.79972659435435 | time 5243.982793331146
Epoch 0 | Batch 9999/31119 | Training PPL: 185.6257354308336 | time 5827.171648740768
Epoch 0 | Validation PPL: 169.20607383580943 | Learning rate: 1.9938476426654456e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.0_10000
Epoch 0 | Batch 10999/31119 | Training PPL: 169.70397819327263 | time 6473.852981090546
Epoch 0 | Batch 11999/31119 | Training PPL: 167.57162079474259 | time 7056.6674518585205
Epoch 0 | Batch 12999/31119 | Training PPL: 98.10619460580436 | time 7639.0904948711395
Epoch 0 | Batch 13999/31119 | Training PPL: 116.26302526318544 | time 8221.501487731934
Epoch 0 | Batch 14999/31119 | Training PPL: 94.77065256894596 | time 8803.925812005997
Epoch 0 | Batch 15999/31119 | Training PPL: 83.40624784982008 | time 9386.951437234879
Epoch 0 | Batch 16999/31119 | Training PPL: 87.11514913570203 | time 9969.547437906265
Epoch 0 | Batch 17999/31119 | Training PPL: 67.26776226904404 | time 10552.418179273605
Epoch 0 | Batch 18999/31119 | Training PPL: 95.74244487768098 | time 11134.983368396759
Epoch 0 | Batch 19999/31119 | Training PPL: 76.27373543394695 | time 11716.63959646225
Epoch 0 | Validation PPL: 62.523046962692085 | Learning rate: 1.9495087953153213e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.0_20000
Epoch 0 | Batch 20999/31119 | Training PPL: 80.26832002625727 | time 12362.295544624329
Epoch 0 | Batch 21999/31119 | Training PPL: 61.341844643986974 | time 12944.713665246964
Epoch 0 | Batch 22999/31119 | Training PPL: 77.53851378737377 | time 13527.177206993103
Epoch 0 | Batch 23999/31119 | Training PPL: 64.43955259770512 | time 14109.583861589432
Epoch 0 | Batch 24999/31119 | Training PPL: 75.4116166719356 | time 14691.947467565536
Epoch 0 | Batch 25999/31119 | Training PPL: 64.41150479441261 | time 15274.240790843964
Epoch 0 | Batch 26999/31119 | Training PPL: 59.44568156112356 | time 15856.514802217484
Epoch 0 | Batch 27999/31119 | Training PPL: 41.76670675630153 | time 16438.86719584465
Epoch 0 | Batch 28999/31119 | Training PPL: 47.48457722235673 | time 17021.05294442177
Epoch 0 | Batch 29999/31119 | Training PPL: 58.14196362322163 | time 17603.161781072617
Epoch 0 | Validation PPL: 37.727704697850825 | Learning rate: 1.864180927647305e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.0_30000
Epoch 0 | Batch 30999/31119 | Training PPL: 34.833897959669116 | time 18248.77923488617
End of epoch 0 | Validation PPL: 36.49085327810097 | Learning rate: 1.8523039316552525e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.0
Epoch 1 | Batch 999/31119 | Training PPL: 41.850078223631314 | time 583.8014943599701
Epoch 1 | Batch 1999/31119 | Training PPL: 46.619119023556635 | time 1167.3053712844849
Epoch 1 | Batch 2999/31119 | Training PPL: 42.93415379553472 | time 1750.5967826843262
Epoch 1 | Batch 3999/31119 | Training PPL: 36.4446328572168 | time 2333.8138382434845
Epoch 1 | Batch 4999/31119 | Training PPL: 42.45457929752554 | time 2916.9507217407227
Epoch 1 | Batch 5999/31119 | Training PPL: 39.76926043827669 | time 3499.8738148212433
Epoch 1 | Batch 6999/31119 | Training PPL: 44.90557057939332 | time 4082.695724964142
Epoch 1 | Batch 7999/31119 | Training PPL: 37.14233036664707 | time 4665.43715429306
Epoch 1 | Batch 8999/31119 | Training PPL: 35.19773558236306 | time 5248.901416301727
Epoch 1 | Batch 9999/31119 | Training PPL: 35.52403477011143 | time 5832.318897724152
Epoch 1 | Validation PPL: 29.180601661038178 | Learning rate: 1.7258217239233546e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.1_10000
Epoch 1 | Batch 10999/31119 | Training PPL: 41.718538032725334 | time 6478.544356107712
Epoch 1 | Batch 11999/31119 | Training PPL: 29.420211940225393 | time 7062.0196578502655
Epoch 1 | Batch 12999/31119 | Training PPL: 23.631284065633917 | time 7645.612205505371
Epoch 1 | Batch 13999/31119 | Training PPL: 27.163946878052446 | time 8229.232621908188
Epoch 1 | Batch 14999/31119 | Training PPL: 30.16632155789235 | time 8812.220390558243
Epoch 1 | Batch 15999/31119 | Training PPL: 25.328276868563027 | time 9395.713453531265
Epoch 1 | Batch 16999/31119 | Training PPL: 29.96706781119145 | time 9979.047210931778
Epoch 1 | Batch 17999/31119 | Training PPL: 25.129726686837344 | time 10562.554621219635
Epoch 1 | Batch 18999/31119 | Training PPL: 36.58447311384345 | time 11145.87262058258
Epoch 1 | Batch 19999/31119 | Training PPL: 31.2705581606245 | time 11729.388394117355
Epoch 1 | Validation PPL: 25.250225992920676 | Learning rate: 1.568006766525687e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.1_20000
Epoch 1 | Batch 20999/31119 | Training PPL: 33.17415049823017 | time 12375.127017974854
Epoch 1 | Batch 21999/31119 | Training PPL: 28.09584204276486 | time 12957.630687475204
Epoch 1 | Batch 22999/31119 | Training PPL: 35.67052108822785 | time 13540.049123287201
Epoch 1 | Batch 23999/31119 | Training PPL: 30.250472511831433 | time 14122.23084783554
Epoch 1 | Batch 24999/31119 | Training PPL: 33.57842773616516 | time 14704.149930715561
Epoch 1 | Batch 25999/31119 | Training PPL: 35.35701027402083 | time 15285.671507358551
Epoch 1 | Batch 26999/31119 | Training PPL: 32.84230065321445 | time 15867.815064430237
Epoch 1 | Batch 27999/31119 | Training PPL: 23.587395504077193 | time 16450.722740650177
Epoch 1 | Batch 28999/31119 | Training PPL: 27.632012444541466 | time 17033.58158636093
Epoch 1 | Batch 29999/31119 | Training PPL: 34.770190126487726 | time 17616.313880205154
Epoch 1 | Validation PPL: 22.85077258963269 | Learning rate: 1.3856717193629852e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.1_30000
Epoch 1 | Batch 30999/31119 | Training PPL: 20.73140764608132 | time 18260.885535001755
End of epoch 1 | Validation PPL: 22.650507905739698 | Learning rate: 1.3642151166328977e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.1
Epoch 2 | Batch 999/31119 | Training PPL: 24.852410742247855 | time 581.7005350589752
Epoch 2 | Batch 1999/31119 | Training PPL: 29.190614785938433 | time 1163.2227292060852
Epoch 2 | Batch 2999/31119 | Training PPL: 27.153793797066108 | time 1744.647738456726
Epoch 2 | Batch 3999/31119 | Training PPL: 22.950186288495523 | time 2325.8984541893005
Epoch 2 | Batch 4999/31119 | Training PPL: 27.200705809099112 | time 2907.0459377765656
Epoch 2 | Batch 5999/31119 | Training PPL: 26.30389371099447 | time 3488.09645986557
Epoch 2 | Batch 6999/31119 | Training PPL: 30.011683955132128 | time 4069.0935027599335
Epoch 2 | Batch 7999/31119 | Training PPL: 27.21504826370766 | time 4649.933667182922
Epoch 2 | Batch 8999/31119 | Training PPL: 24.41711611763072 | time 5230.663846731186
Epoch 2 | Batch 9999/31119 | Training PPL: 24.729635169393386 | time 5811.223693370819
Epoch 2 | Validation PPL: 21.12669879227 | Learning rate: 1.1639008267808411e-05
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.2_10000
Epoch 2 | Batch 10999/31119 | Training PPL: 30.052805236223442 | time 6454.087569475174
Epoch 2 | Batch 11999/31119 | Training PPL: 21.31452227919764 | time 7034.246039152145
Epoch 2 | Batch 12999/31119 | Training PPL: 17.989330865405353 | time 7614.365778207779
Epoch 2 | Batch 13999/31119 | Training PPL: 19.931729479817538 | time 8194.38102388382
Epoch 2 | Batch 14999/31119 | Training PPL: 23.296664235842083 | time 8774.39814710617
Epoch 2 | Batch 15999/31119 | Training PPL: 19.547370693005465 | time 9354.43612909317
Epoch 2 | Batch 16999/31119 | Training PPL: 23.264277092607536 | time 9934.48769235611
Epoch 2 | Batch 17999/31119 | Training PPL: 19.56007456289351 | time 10514.506144285202
Epoch 2 | Batch 18999/31119 | Training PPL: 28.21214152129027 | time 11094.536075353622
Epoch 2 | Batch 19999/31119 | Training PPL: 24.48587144094972 | time 11674.320500850677
Epoch 2 | Validation PPL: 20.03959823709021 | Learning rate: 9.565111582148803e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.2_20000
Epoch 2 | Batch 20999/31119 | Training PPL: 26.015723000769214 | time 12316.665240764618
Epoch 2 | Batch 21999/31119 | Training PPL: 22.384993651895606 | time 12896.448219537735
Epoch 2 | Batch 22999/31119 | Training PPL: 28.20325075562657 | time 13476.239280462265
Epoch 2 | Batch 23999/31119 | Training PPL: 23.99543485475947 | time 14056.143252849579
Epoch 2 | Batch 24999/31119 | Training PPL: 26.298375513368875 | time 14636.00751900673
Epoch 2 | Batch 25999/31119 | Training PPL: 28.53659301562859 | time 15215.96432876587
Epoch 2 | Batch 26999/31119 | Training PPL: 26.98442782893204 | time 15795.862627267838
Epoch 2 | Batch 27999/31119 | Training PPL: 19.69353507105683 | time 16375.799205064774
Epoch 2 | Batch 28999/31119 | Training PPL: 22.434516990580153 | time 16955.747282981873
Epoch 2 | Batch 29999/31119 | Training PPL: 29.42886187445655 | time 17535.666045427322
Epoch 2 | Validation PPL: 19.242701820517137 | Learning rate: 7.509988445805716e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.2_30000
Epoch 2 | Batch 30999/31119 | Training PPL: 17.118490203557094 | time 18178.197684526443
End of epoch 2 | Validation PPL: 19.20486205200695 | Learning rate: 7.286507021515823e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.2
Epoch 3 | Batch 999/31119 | Training PPL: 20.73524852072339 | time 580.2697169780731
Epoch 3 | Batch 1999/31119 | Training PPL: 24.648357000226344 | time 1160.4234373569489
Epoch 3 | Batch 2999/31119 | Training PPL: 23.2320900645628 | time 1740.5586404800415
Epoch 3 | Batch 3999/31119 | Training PPL: 19.41515531137751 | time 2320.629420518875
Epoch 3 | Batch 4999/31119 | Training PPL: 22.898601963547073 | time 2900.8043897151947
Epoch 3 | Batch 5999/31119 | Training PPL: 22.197160610365344 | time 3480.9656267166138
Epoch 3 | Batch 6999/31119 | Training PPL: 25.96337590348084 | time 4061.337364912033
Epoch 3 | Batch 7999/31119 | Training PPL: 24.018289515142843 | time 4642.241127729416
Epoch 3 | Batch 8999/31119 | Training PPL: 21.36000182730319 | time 5223.450737476349
Epoch 3 | Batch 9999/31119 | Training PPL: 21.46532140322249 | time 5804.7142996788025
Epoch 3 | Validation PPL: 18.669654152325894 | Learning rate: 5.3561428039020314e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.3_10000
Epoch 3 | Batch 10999/31119 | Training PPL: 25.75043988167457 | time 6448.541898012161
Epoch 3 | Batch 11999/31119 | Training PPL: 18.808632121892035 | time 7029.787296295166
Epoch 3 | Batch 12999/31119 | Training PPL: 15.767021369991184 | time 7611.185161113739
Epoch 3 | Batch 13999/31119 | Training PPL: 17.678602045938323 | time 8192.677891492844
Epoch 3 | Batch 14999/31119 | Training PPL: 20.81686555457762 | time 8774.145368337631
Epoch 3 | Batch 15999/31119 | Training PPL: 17.634173835678634 | time 9355.75748181343
Epoch 3 | Batch 16999/31119 | Training PPL: 20.719276738634072 | time 9937.628759145737
Epoch 3 | Batch 17999/31119 | Training PPL: 17.643093442161835 | time 10519.834854364395
Epoch 3 | Batch 18999/31119 | Training PPL: 25.257981102019475 | time 11102.291918039322
Epoch 3 | Batch 19999/31119 | Training PPL: 22.03756293533784 | time 11685.027954101562
Epoch 3 | Validation PPL: 18.29130760814257 | Learning rate: 3.6262476687268443e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.3_20000
Epoch 3 | Batch 20999/31119 | Training PPL: 23.410226804559752 | time 12330.487441062927
Epoch 3 | Batch 21999/31119 | Training PPL: 20.23082906029459 | time 12913.260739564896
Epoch 3 | Batch 22999/31119 | Training PPL: 25.594171377712865 | time 13495.901781320572
Epoch 3 | Batch 23999/31119 | Training PPL: 21.692535019721106 | time 14078.279876947403
Epoch 3 | Batch 24999/31119 | Training PPL: 23.610188009812568 | time 14661.993602514267
Epoch 3 | Batch 25999/31119 | Training PPL: 26.40671832280152 | time 15245.969814777374
Epoch 3 | Batch 26999/31119 | Training PPL: 25.03815371887495 | time 15829.960943460464
Epoch 3 | Batch 27999/31119 | Training PPL: 18.05997162915653 | time 16414.046998023987
Epoch 3 | Batch 28999/31119 | Training PPL: 20.814518127631363 | time 16998.20056605339
Epoch 3 | Batch 29999/31119 | Training PPL: 27.29717451758462 | time 17582.45924592018
Epoch 3 | Validation PPL: 18.072915292819925 | Learning rate: 2.1714988672104243e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.3_30000
Epoch 3 | Batch 30999/31119 | Training PPL: 15.868293457372257 | time 18229.291256666183
End of epoch 3 | Validation PPL: 18.034460382027234 | Learning rate: 2.0295926804767984e-06
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.3
Epoch 4 | Batch 999/31119 | Training PPL: 19.459838830794315 | time 582.5691974163055
Epoch 4 | Batch 1999/31119 | Training PPL: 23.10016243221026 | time 1166.1735286712646
Epoch 4 | Batch 2999/31119 | Training PPL: 21.538578508012517 | time 1748.905091047287
Epoch 4 | Batch 3999/31119 | Training PPL: 18.450619587279405 | time 2332.3977229595184
Epoch 4 | Batch 4999/31119 | Training PPL: 21.538804457878154 | time 2915.8087735176086
Epoch 4 | Batch 5999/31119 | Training PPL: 21.09135858687802 | time 3499.226193189621
Epoch 4 | Batch 6999/31119 | Training PPL: 24.772229169329577 | time 4082.217345714569
Epoch 4 | Batch 7999/31119 | Training PPL: 22.8121024090208 | time 4665.738098144531
Epoch 4 | Batch 8999/31119 | Training PPL: 20.273570933041203 | time 5248.913026332855
Epoch 4 | Batch 9999/31119 | Training PPL: 20.50927783947915 | time 5832.380941867828
Epoch 4 | Validation PPL: 17.901416208303655 | Learning rate: 9.536375790975316e-07
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.4_10000
Epoch 4 | Batch 10999/31119 | Training PPL: 24.641852433374936 | time 6478.626289844513
Epoch 4 | Batch 11999/31119 | Training PPL: 17.867636783450074 | time 7061.785328626633
Epoch 4 | Batch 12999/31119 | Training PPL: 15.334733524329117 | time 7643.455518007278
Epoch 4 | Batch 13999/31119 | Training PPL: 17.048970990962818 | time 8225.3088722229
Epoch 4 | Batch 14999/31119 | Training PPL: 20.283046995063952 | time 8807.280395746231
Epoch 4 | Batch 15999/31119 | Training PPL: 17.057899610124547 | time 9389.742412567139
Epoch 4 | Batch 16999/31119 | Training PPL: 20.267607152948337 | time 9973.079054355621
Epoch 4 | Batch 17999/31119 | Training PPL: 17.211421202840985 | time 10555.636470079422
Epoch 4 | Batch 18999/31119 | Training PPL: 24.550734390914133 | time 11138.14293718338
Epoch 4 | Batch 19999/31119 | Training PPL: 21.364921866015848 | time 11723.0263838768
Epoch 4 | Validation PPL: 17.840108742496373 | Learning rate: 2.6820180192341007e-07
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.4_20000
Epoch 4 | Batch 20999/31119 | Training PPL: 22.745156388302608 | time 12370.170016765594
Epoch 4 | Batch 21999/31119 | Training PPL: 19.72044814898304 | time 12952.35060095787
Epoch 4 | Batch 22999/31119 | Training PPL: 24.898118829158573 | time 13534.528179645538
Epoch 4 | Batch 23999/31119 | Training PPL: 21.202661992982037 | time 14117.061531305313
Epoch 4 | Batch 24999/31119 | Training PPL: 23.12337722019204 | time 14699.562056541443
Epoch 4 | Batch 25999/31119 | Training PPL: 25.825135376531524 | time 15282.288439750671
Epoch 4 | Batch 26999/31119 | Training PPL: 24.356426909198426 | time 15865.327461719513
Epoch 4 | Batch 27999/31119 | Training PPL: 17.95076277416173 | time 16447.685466766357
Epoch 4 | Batch 28999/31119 | Training PPL: 20.360743202310488 | time 17030.173091173172
Epoch 4 | Batch 29999/31119 | Training PPL: 26.90262033105967 | time 17612.301250219345
Epoch 4 | Validation PPL: 17.8251515078509 | Learning rate: 2.8746915027277887e-09
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.4_30000
Epoch 4 | Batch 30999/31119 | Training PPL: 15.752108357420678 | time 18258.808540582657
End of epoch 4 | Validation PPL: 17.824786024730496 | Learning rate: 3.4659879899479052e-12
Save checkpoint to exp/gpt2-medium_scratch_neuro_tokenizer_spt/checkpoint.4
